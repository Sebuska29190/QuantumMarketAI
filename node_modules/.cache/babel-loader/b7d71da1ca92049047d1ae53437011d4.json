{"ast":null,"code":"import _slicedToArray from\"/home/sebastian/Pobrane/cryptowatch/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Grid,Skeleton}from'@mui/material';import React,{useEffect,useState}from'react';import InfiniteScroll from'react-infinite-scroll-component';import{Subject,takeUntil}from'rxjs';import ExchangesList from'../components/ExchangesList';import ExchangesListSkeleton from'../components/ExchangesListSkeleton';import{retrieveExchangesAction}from'../store/exchangesSlice';import{useAppDispatch,useAppSelector}from'../store/hooks';import{jsx as _jsx}from\"react/jsx-runtime\";function Exchanges(){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),page=_useState4[0],setPage=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),hasMore=_useState6[0],setHasMore=_useState6[1];var _useState7=useState(new Subject()),_useState8=_slicedToArray(_useState7,1),destroy$=_useState8[0];var exchangesState=useAppSelector(function(state){return state.exchanges;});var dispatch=useAppDispatch();var retrieveExchanges=function retrieveExchanges(){retrieveExchangesAction(exchangesState,dispatch,{page:page}).pipe(takeUntil(destroy$)).subscribe(function(res){if(page===1){// reset loading for initial call\nsetLoading(false);}if(res.length<60){// assuming page size is 60\nsetHasMore(false);}if(res.length>0){// we don't need to increment the offset if there is no more data to fetch\nsetPage(page+1);}});};useEffect(function(){window.scroll({top:0});// scroll to top to prevent fetching next page\nretrieveExchanges();return function(){destroy$.next();destroy$.complete();};// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);if(loading)return/*#__PURE__*/_jsx(Grid,{container:true,spacing:2,children:/*#__PURE__*/_jsx(ExchangesListSkeleton,{size:24})});return/*#__PURE__*/_jsx(InfiniteScroll,{style:{overflow:\"inherit\"},next:retrieveExchanges,dataLength:exchangesState.data.length,hasMore:hasMore,loader:/*#__PURE__*/_jsx(Skeleton,{width:\"60%\"}),scrollThreshold:\"20px\",children:/*#__PURE__*/_jsx(Grid,{container:true,spacing:2,children:/*#__PURE__*/_jsx(ExchangesList,{exchanges:exchangesState.data})})});}export default Exchanges;","map":null,"metadata":{},"sourceType":"module"}